package com.leetcode.java;

/**
 *

 Given a string representing arbitrarily nested ternary expressions, calculate the result of the expression. You can always assume that the given expression is valid and only consists of digits 0-9, ?, :, T and F (T and F represent True and False respectively).

 Note:

 The length of the given string is â‰¤ 10000.
 Each number will contain only one digit.
 The conditional expressions group right-to-left (as usual in most languages).
 The condition will always be either T or F. That is, the condition will never be a digit.
 The result of the expression will always evaluate to either a digit 0-9, T or F.
 Example 1:

 Input: "T?2:3"

 Output: "2"

 Explanation: If true, then result is 2; otherwise result is 3.
 Example 2:

 Input: "F?1:T?4:5"

 Output: "4"

 Explanation: The conditional expressions group right-to-left. Using parenthesis, it is read/evaluated as:

 "(F ? 1 : (T ? 4 : 5))"                   "(F ? 1 : (T ? 4 : 5))"
 -> "(F ? 1 : 4)"                 or       -> "(T ? 4 : 5)"
 -> "4"                                    -> "4"
 Example 3:

 Input: "T?T?F:5:3"

 Output: "F"

 Explanation: The conditional expressions group right-to-left. Using parenthesis, it is read/evaluated as:

 "(T ? (T ? F : 5) : 3)"                   "(T ? (T ? F : 5) : 3)"
 -> "(T ? F : 3)"                 or       -> "(T ? F : 5)"
 -> "F"                                    -> "F"

 * @author mengchaowang
 *
 */
public class Q439Contest {

  public String parseTernary(String expression) {
    if (expression.lastIndexOf("?") != -1) {
      int lidx = expression.lastIndexOf("?");
      String sub = expression.substring(lidx + 1);
      String value = expression.substring(lidx - 1, lidx);
      int fcoloumn = sub.indexOf(":") + lidx + 1;
      int end = expression.substring(fcoloumn + 1).indexOf(":");
      if (end == -1) {
        end = expression.length();
      } else {
        end += fcoloumn + 1;
      }
      String result;
      if (value.equals("T")) {
        result = expression.substring(lidx + 1, fcoloumn);
      } else {
        result = expression.substring(fcoloumn + 1, end);
      }
      expression = expression.replace(expression.subSequence(lidx - 1, end), result);
      return parseTernary(expression);
    } else {
      return expression;
    }
  }

  public static void main(String[] args) {
    Q439Contest q = new Q439Contest();
    // System.out.println(q.parseTernary("T?2:3"));
    // System.out.println(q.parseTernary("F?1:T?4:5"));
    // System.out.println(q.parseTernary("T?T?F:5:3"));
    String test = "F?F?3:8:T?F:T?0:F?8:T?T?F?F?0:T?5:3:T?F?F:F?F?7:6:0:F?F?F?T?0:T?7:6:6:8:F:T:F?F?F?T?0:T:T?T?9:F?T?T?2:T?F?8:T?7:0:T:T?6:F?3:F?F?F:9:9:5:2:7:T?8:F?6:T?6:F?9:T?T?2:T:F?F?F?9:2:T?0:2:T?T?F?F?9:1:T?3:F?4:0:3:F?F:T?F?T:6:T?5:F?T?T?T?F?3:T?4:0:2:2:F?0:F?T?F?1:T?0:F?8:T?F?F?F:T?T:T?T?6:T?T?4:T?T?1:T?7:7:F?T?5:9:F?F:T?0:T?T?T?T?7:F?F?T?F?6:T?4:F:F?9:7:F?6:3:F?T?T?T?6:4:T?T?F?0:2:T?0:T?F?1:T?0:F?7:T?2:F?F?3:6:F:T?2:T?T?4:T?2:T?T?F?F?F:T?F?T?6:T?3:F?1:3:T?6:F?F?2:T?T:T?0:T?T?5:9:T?6:9:F?9:F?F?T:F:F?9:7:T?3:9:T?9:F?T?F?0:F?T?1:7:4:6:3:T?T?0:F?T?T?T?T?T?4:F?F?F?F:6:T?6:T?0:7:F?6:1:T?T?T?4:F?7:3:F?F:F?7:5:F?F?T:0:F?T?F:7:T?F:3:8:F?1:T?T?3:3:8:5:1:3:T?T?F:T?F?6:T?T?4:T?7:6:T?9:7:F?9:T?T?1:6:3:F?9:F?F?F?T?F?F?T?4:9:T?9:4:6:0:T?0:F:F:F:F?0:F?F?8:T?F?7:F:T:3:T?7:F?F:F?F?T:F:T?4:F?T?F?0:T?4:F?T?F?4:F?F?F?T?T:T?0:T?F?T?3:F?T?T?7:7:5:F?F?F:9:T:F?T?T?F?T?T:7:0:T?F?T:F?3:T?4:9:5:6:F?4:0:T?7:0:F:6:0:1:2:2:T?7:T?8:F:F?4:1:T?F:T:F?F?T?F:F?T?4:T?T?T:3:T?T?3:T?4:2:9:F?T:F?F?1:F?1:0:F?T?F?4:F?F?7:7:T?3:T:T?T:8:T?T?8:5:T?6:3:2:4:3:F?F?3:0:0:F?T?T?F?4:1:F?T?5:F?9:F?F?T?4:F?3:3:5:T?T?T:2:T?1:6:F?T?T?F?F?T?F?F:T:F:F?5:6:2:3:3:F?9:2:T?5:F?F?F?3:F?T?F?T?F?3:F?F?F?7:T:F?4:9:T?4:F?T?8:F?5:F?8:3:T:F?0:T?F:F?F?8:T?F?F?T?T?F:T?0:3:4:F?F?4:F?7:T:1:2:T?F?F?F?F?5:0:9:9:T?T?3:4:1:F?0:3:1:T?T?1:8:T:3:F?0:9:5:F:F?F?F?F?T?F:5:T?0:9:7:T?T:0:1:F:F?T?T?F?F?F?T?T?F?3:F?F?3:6:F?9:F?F:3:T?2:9:F?1:T?T?T?F:F?T?F?8:3:8:F?F?T:2:0:8:9:F?T?T?2:F?T?9:1:3:T?8:T?F?F?5:T?T?F?F?1:F?7:T?T?1:T?6:F?1:F?T?5:1:F?F?T?1:9:6:3:5:6:4:9:5:F?1:T?T?T?T?F?F?F?8:T?T:F?F?F?T?T?3:F?6:5:5:F?F?T?7:T?5:5:F?F?6:2:3:5:T?F?3:T?T?F?T:8:1:2:F?0:T?F?2:F?F?T?T?T?0:0:T?8:0:T?F?T?2:6:T?F?T:1:1:8:6:F?F?T:F?T?T?F?F?F?4:T?F?5:T?F:T?F?4:9:9:6:3:9:5:T?0:T:2:1:7:F?7:T?9:T?F?F?6:8:3:F?F?5:T?F:5:T?F?1:F?F?T?F?F?6:8:F:4:F?F?T?F:F?F?0:F?7:2:T?8:T?F?9:8:7:1:6:T?T?5:8:T?3:F?4:7:F?T?7:T?9:6:T?T?T?9:F?F?T?T?T?F:2:2:9:T?T?8:F?T?3:F?T?F?F?7:0:T?F?T:F?T?7:3:F:T?8:F?T?T?1:6:F?2:T?T?3:3:T?F?6:T?T?T?T?2:T?T?F?T?7:5:T?T?T?F?2:F?T?T?F?T?F:F?F?T?F?2:7:F?2:T?T?T?T?7:9:8:T?F?T:F:9:4:3:4:1:F:9:8:8:F:F:8:6:F:3:8:3:6:9:8:9:F:6:2:9:4:9:0:4:2:1:7:8:T:5:3:F:4:5:1:6";
    System.out.println(q.parseTernary(test));

  }
}
